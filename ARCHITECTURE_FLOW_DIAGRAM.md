# ğŸ—ï¸ TrackFlow Architecture Flow Diagram

## Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TRACKFLOW ECOSYSTEM                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           1. BUILDER LAYER (React/TypeScript)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Workflow     â”‚  â”‚ Node Config  â”‚  â”‚ Selector     â”‚  â”‚ Integration  â”‚    â”‚
â”‚  â”‚ Builder      â”‚  â”‚ Panel        â”‚  â”‚ Builder      â”‚  â”‚ Modal        â”‚    â”‚
â”‚  â”‚ .tsx         â”‚  â”‚ .tsx         â”‚  â”‚ .tsx         â”‚  â”‚ .tsx         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                    â”‚                                          â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚                          â”‚   React Hook Form  â”‚                               â”‚
â”‚                          â”‚   + Zod Validation â”‚                               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                    â”‚                                          â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚                          â”‚   TanStack Query   â”‚                               â”‚
â”‚                          â”‚   (Data Fetching)  â”‚                               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                    â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ HTTP/REST API
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        2. BACKEND LAYER (Node.js/Express)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      API Endpoints                                   â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  POST   /api/workflows                  (Create workflow)            â”‚    â”‚
â”‚  â”‚  GET    /api/workflows                  (List workflows)             â”‚    â”‚
â”‚  â”‚  GET    /api/workflows/:id              (Get workflow)               â”‚    â”‚
â”‚  â”‚  PUT    /api/workflows/:id              (Update workflow)            â”‚    â”‚
â”‚  â”‚  DELETE /api/workflows/:id              (Delete workflow)            â”‚    â”‚
â”‚  â”‚  GET    /api/workflows/active           (Get active workflows)       â”‚    â”‚
â”‚  â”‚  POST   /api/track-execution            (Track execution)            â”‚    â”‚
â”‚  â”‚  POST   /api/journey-update             (Update journey)             â”‚    â”‚
â”‚  â”‚  GET    /api/journey-analytics/summary  (Analytics)                  â”‚    â”‚
â”‚  â”‚  GET    /api/scrape                     (Scrape website)             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                               â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                    â”‚  Data Transformation â”‚                                   â”‚
â”‚                    â”‚  & Business Logic    â”‚                                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                               â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ SQL/RPC
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        3. DATABASE LAYER (Supabase/PostgreSQL)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   workflows  â”‚  â”‚workflow_nodesâ”‚  â”‚  workflow_   â”‚  â”‚user_journeys â”‚    â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚ connections  â”‚  â”‚              â”‚    â”‚
â”‚  â”‚ â€¢ id         â”‚  â”‚ â€¢ id         â”‚  â”‚ â€¢ id         â”‚  â”‚ â€¢ session_id â”‚    â”‚
â”‚  â”‚ â€¢ name       â”‚  â”‚ â€¢ workflow_idâ”‚  â”‚ â€¢ source_id  â”‚  â”‚ â€¢ intent_    â”‚    â”‚
â”‚  â”‚ â€¢ status     â”‚  â”‚ â€¢ type       â”‚  â”‚ â€¢ target_id  â”‚  â”‚   score      â”‚    â”‚
â”‚  â”‚ â€¢ target_url â”‚  â”‚ â€¢ config     â”‚  â”‚              â”‚  â”‚ â€¢ pages[]    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚journey_pages â”‚  â”‚journey_eventsâ”‚  â”‚ executions   â”‚                       â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚                       â”‚
â”‚  â”‚ â€¢ page_path  â”‚  â”‚ â€¢ event_type â”‚  â”‚ â€¢ workflow_idâ”‚                       â”‚
â”‚  â”‚ â€¢ time_on_   â”‚  â”‚ â€¢ timestamp  â”‚  â”‚ â€¢ timestamp  â”‚                       â”‚
â”‚  â”‚   page       â”‚  â”‚ â€¢ target     â”‚  â”‚ â€¢ success    â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ JS Scripts Served
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     4. CLIENT RUNTIME (Vanilla JavaScript)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                 Unified Workflow System                              â”‚    â”‚
â”‚  â”‚              (unifiedWorkflowSystem.js)                              â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â€¢ Fetches active workflows                                          â”‚    â”‚
â”‚  â”‚  â€¢ Tracks events (scroll, click, form, navigation)                   â”‚    â”‚
â”‚  â”‚  â€¢ Evaluates triggers                                                â”‚    â”‚
â”‚  â”‚  â€¢ Executes actions                                                  â”‚    â”‚
â”‚  â”‚  â€¢ Resolves elements using strategies                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                Cookie-Free Journey Tracker                           â”‚    â”‚
â”‚  â”‚                  (journeyTracker.js)                                 â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â€¢ Tracks page visits                                                â”‚    â”‚
â”‚  â”‚  â€¢ Calculates intent scores                                          â”‚    â”‚
â”‚  â”‚  â€¢ Detects user patterns                                             â”‚    â”‚
â”‚  â”‚  â€¢ Stores in sessionStorage/localStorage                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ DOM Manipulation
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          5. TARGET WEBSITE DOM                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Website HTML/CSS/JS                              â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  <header>                                                            â”‚    â”‚
â”‚  â”‚    <nav>...</nav>                                                    â”‚    â”‚
â”‚  â”‚  </header>                                                           â”‚    â”‚
â”‚  â”‚  <main>                                                              â”‚    â”‚
â”‚  â”‚    <div class="hero">                                                â”‚    â”‚
â”‚  â”‚      <h1 class="headline">Original Text</h1>  â† TARGETED             â”‚    â”‚
â”‚  â”‚      <button class="cta-button">Click</button>  â† TRACKED            â”‚    â”‚
â”‚  â”‚    </div>                                                            â”‚    â”‚
â”‚  â”‚  </main>                                                             â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Workflow Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WORKFLOW EXECUTION FLOW                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Event Occurs
   â”œâ”€ Page Load
   â”œâ”€ User Scroll
   â”œâ”€ Element Click
   â”œâ”€ Form Focus
   â””â”€ Navigation
      â”‚
      â–¼
2. Event Tracking
   â””â”€ unifiedWorkflowSystem.trackEvent(eventData)
      â”‚
      â–¼
3. Load Active Workflows
   â””â”€ GET /api/workflows/active
      â”‚
      â–¼
4. Trigger Evaluation Loop
   â””â”€ For each workflow:
      â”œâ”€ Find trigger nodes
      â”œâ”€ Evaluate trigger conditions
      â””â”€ If match found â†’ Continue
         â”‚
         â–¼
5. Find Connected Actions
   â””â”€ Follow connections from trigger node
      â”‚
      â–¼
6. Execute Actions Sequentially
   â””â”€ For each action:
      â”‚
      â”œâ”€ Resolve Target Element
      â”‚  â”‚
      â”‚  â”œâ”€ Try Strategy 1 (ID)
      â”‚  â”‚  â””â”€ 1 match? âœ“ Use it
      â”‚  â”‚
      â”‚  â”œâ”€ Try Strategy 2 (Data Attr)
      â”‚  â”‚  â””â”€ 1 match? âœ“ Use it
      â”‚  â”‚
      â”‚  â”œâ”€ Try Strategy 3 (Class)
      â”‚  â”‚  â”œâ”€ Multiple matches?
      â”‚  â”‚  â””â”€ Disambiguate:
      â”‚  â”‚     â”œâ”€ Text content match
      â”‚  â”‚     â”œâ”€ Position match
      â”‚  â”‚     â””â”€ Attribute match
      â”‚  â”‚
      â”‚  â””â”€ Element found? Continue
      â”‚
      â”œâ”€ Execute Action Operation
      â”‚  â”‚
      â”‚  â”œâ”€ Replace Text
      â”‚  â”‚  â””â”€ element.textContent = newText
      â”‚  â”‚
      â”‚  â”œâ”€ Change Style
      â”‚  â”‚  â””â”€ element.style[property] = value
      â”‚  â”‚
      â”‚  â”œâ”€ Display Overlay
      â”‚  â”‚  â””â”€ document.body.appendChild(overlay)
      â”‚  â”‚
      â”‚  â””â”€ Redirect
      â”‚     â””â”€ window.location.href = url
      â”‚
      â””â”€ Track Execution
         â””â”€ POST /api/track-execution
            â”‚
            â–¼
7. Update Analytics
   â””â”€ Store in database
      â””â”€ Show in dashboard
```

---

## Element Targeting Strategy Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ELEMENT TARGETING RESOLUTION                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Start: Need to find element for action
â”‚
â”œâ”€ Has selectorStrategies? â”€â”€[NO]â”€â”€> Generate from selector â”€â”
â”‚                                                              â”‚
[YES]                                                          â”‚
â”‚                                                              â”‚
â–¼                                                              â”‚
Sort strategies by reliability (highest first) <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FOR EACH STRATEGY (in order):                          â”‚
â”‚                                                          â”‚
â”‚ 1. Query DOM: document.querySelectorAll(strategy.sel)   â”‚
â”‚                                                          â”‚
â”‚ 2. Count matches:                                       â”‚
â”‚    â”‚                                                     â”‚
â”‚    â”œâ”€ 0 matches  â”€â”€> Try next strategy                  â”‚
â”‚    â”‚                                                     â”‚
â”‚    â”œâ”€ 1 match    â”€â”€> âœ“ Found! Return element            â”‚
â”‚    â”‚                                                     â”‚
â”‚    â””â”€ Multiple   â”€â”€> DISAMBIGUATION NEEDED              â”‚
â”‚                      â”‚                                   â”‚
â”‚                      â”œâ”€ Text Content Match?             â”‚
â”‚                      â”‚  â””â”€ element.textContent          â”‚
â”‚                      â”‚     includes originalText        â”‚
â”‚                      â”‚                                   â”‚
â”‚                      â”œâ”€ Exact Text Match?               â”‚
â”‚                      â”‚  â””â”€ element.textContent          â”‚
â”‚                      â”‚     === textContent              â”‚
â”‚                      â”‚                                   â”‚
â”‚                      â”œâ”€ Position Match?                 â”‚
â”‚                      â”‚  â””â”€ elements[position]           â”‚
â”‚                      â”‚                                   â”‚
â”‚                      â”œâ”€ Attribute Match?                â”‚
â”‚                      â”‚  â””â”€ element.getAttribute()       â”‚
â”‚                      â”‚     matches context.attributes   â”‚
â”‚                      â”‚                                   â”‚
â”‚                      â””â”€ First Visible?                  â”‚
â”‚                         â””â”€ element.getBoundingClientRectâ”‚
â”‚                            has size > 0                 â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€ Element found? â”€â”€[YES]â”€â”€> Return TargetingResult { success: true }
â”‚
â””â”€[NO]â”€> Return TargetingResult { success: false, message: 'Element not found' }
```

---

## Journey Tracking Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      JOURNEY TRACKING FLOW                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Page Load
   â”‚
   â–¼
2. Initialize Journey Tracker
   â”‚
   â”œâ”€ Load from sessionStorage?
   â”‚  â”œâ”€[YES]â”€> Restore existing journey
   â”‚  â””â”€[NO]â”€â”€> Create new journey
   â”‚
   â–¼
3. Track Page Visit
   â”‚
   â”œâ”€ Add page to journey.pages[]
   â”œâ”€ Capture:
   â”‚  â”œâ”€ path
   â”‚  â”œâ”€ title
   â”‚  â”œâ”€ referrer
   â”‚  â”œâ”€ timestamp
   â”‚  â””â”€ viewport size
   â”‚
   â–¼
4. Setup Event Tracking
   â”‚
   â”œâ”€ Scroll Tracking
   â”‚  â””â”€ Update scrollDepth on scroll
   â”‚
   â”œâ”€ Click Tracking
   â”‚  â””â”€ Track element clicks
   â”‚
   â”œâ”€ Form Tracking
   â”‚  â””â”€ Track form interactions
   â”‚
   â””â”€ Exit Intent
      â””â”€ Detect mouse leaving viewport
   â”‚
   â–¼
5. Calculate Intent Score
   â”‚
   â”œâ”€ High-Intent Pages (25%)
   â”‚  â””â”€ pricing, checkout, cart
   â”‚
   â”œâ”€ Form Interactions (20%)
   â”‚  â””â”€ email, phone fields
   â”‚
   â”œâ”€ Time on Site (15%)
   â”‚  â””â”€ > 2 minutes
   â”‚
   â”œâ”€ Page Depth (10%)
   â”‚  â””â”€ > 3 pages
   â”‚
   â”œâ”€ Return Visits (15%)
   â”‚  â””â”€ Multiple sessions
   â”‚
   â”œâ”€ Intent Signals (20%)
   â”‚  â””â”€ Demo requests, contact forms
   â”‚
   â””â”€ Scroll Depth (10%)
      â””â”€ > 50% scrolled
   â”‚
   â–¼
6. Determine Intent Level
   â”‚
   â”œâ”€ Score â‰¥ 0.70  â”€â”€> HIGH   (Hot lead)
   â”œâ”€ Score â‰¥ 0.40  â”€â”€> MEDIUM (Warm lead)
   â””â”€ Score < 0.40  â”€â”€> LOW    (Cold lead)
   â”‚
   â–¼
7. Save to Storage
   â”‚
   â”œâ”€ sessionStorage: Current journey
   â”œâ”€ localStorage: Visit count, first visit, UTM
   â””â”€ NO COOKIES! ğŸªâŒ
   â”‚
   â–¼
8. Send to Server (Periodic)
   â”‚
   â””â”€ POST /api/journey-update
      â”‚
      â–¼
9. Store in Database
   â”‚
   â””â”€ Available for:
      â”œâ”€ Journey-based triggers
      â”œâ”€ Analytics dashboard
      â””â”€ Lead scoring
```

---

## Data Structure Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DATABASE RELATIONSHIPS                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

users
  â”‚
  â””â”€â”€ workflows (1:many)
        â”‚
        â”œâ”€â”€ workflow_nodes (1:many)
        â”‚     â”‚
        â”‚     â”œâ”€â”€ type: 'trigger'
        â”‚     â”‚   â””â”€â”€ config: {
        â”‚     â”‚         triggerType: 'page-visits',
        â”‚     â”‚         visitCount: 3,
        â”‚     â”‚         ...
        â”‚     â”‚       }
        â”‚     â”‚
        â”‚     â””â”€â”€ type: 'action'
        â”‚         â””â”€â”€ config: {
        â”‚               actionType: 'replace-text',
        â”‚               selector: '.headline',
        â”‚               selectorStrategies: [...],
        â”‚               ...
        â”‚             }
        â”‚
        â”œâ”€â”€ workflow_connections (1:many)
        â”‚     â””â”€â”€ Connects: trigger â†’ action
        â”‚
        â””â”€â”€ workflow_executions (1:many)
              â””â”€â”€ Tracks when workflows run

user_journeys
  â”‚
  â”œâ”€â”€ journey_pages (1:many)
  â”‚     â””â”€â”€ Individual page visits
  â”‚
  â”œâ”€â”€ journey_events (1:many)
  â”‚     â””â”€â”€ User interactions
  â”‚
  â””â”€â”€ journey_intent_signals (1:many)
        â””â”€â”€ Buying intent indicators
```

---

## Tech Stack Integration Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TECH STACK INTEGRATION                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend (Builder)
â”œâ”€â”€ React 18
â”‚   â””â”€â”€ Component tree
â”‚       â”œâ”€â”€ WorkflowBuilder
â”‚       â”œâ”€â”€ NodeConfigPanel
â”‚       â””â”€â”€ SelectorBuilder
â”‚
â”œâ”€â”€ TypeScript
â”‚   â””â”€â”€ Type definitions
â”‚       â”œâ”€â”€ WorkflowNode
â”‚       â”œâ”€â”€ TargetingStrategy
â”‚       â””â”€â”€ TriggerConfig
â”‚
â”œâ”€â”€ Vite
â”‚   â””â”€â”€ Build & dev server
â”‚       â””â”€â”€ Fast HMR
â”‚
â”œâ”€â”€ Tailwind CSS
â”‚   â””â”€â”€ Styling
â”‚       â””â”€â”€ Utility classes
â”‚
â”œâ”€â”€ shadcn/ui
â”‚   â””â”€â”€ UI components
â”‚       â”œâ”€â”€ Button
â”‚       â”œâ”€â”€ Input
â”‚       â””â”€â”€ Select
â”‚
â”œâ”€â”€ Framer Motion
â”‚   â””â”€â”€ Animations
â”‚       â””â”€â”€ Page transitions
â”‚
â”œâ”€â”€ React Hook Form
â”‚   â””â”€â”€ Form handling
â”‚       â””â”€â”€ + Zod validation
â”‚
â”œâ”€â”€ TanStack Query
â”‚   â””â”€â”€ Data fetching
â”‚       â”œâ”€â”€ useQuery (GET)
â”‚       â””â”€â”€ useMutation (POST/PUT)
â”‚
â””â”€â”€ Lucide React
    â””â”€â”€ Icons
        â”œâ”€â”€ Eye, Clock, Link
        â””â”€â”€ Type, Palette, etc.

Backend (API)
â”œâ”€â”€ Node.js + Express
â”‚   â””â”€â”€ REST API endpoints
â”‚
â””â”€â”€ Supabase Client
    â””â”€â”€ Database operations

Client Runtime (Executor)
â”œâ”€â”€ Vanilla JavaScript
â”‚   â”œâ”€â”€ unifiedWorkflowSystem.js
â”‚   â””â”€â”€ journeyTracker.js
â”‚
â””â”€â”€ Browser APIs
    â”œâ”€â”€ DOM manipulation
    â”œâ”€â”€ sessionStorage
    â”œâ”€â”€ localStorage
    â””â”€â”€ Fetch API

Database
â””â”€â”€ Supabase (PostgreSQL)
    â”œâ”€â”€ Tables
    â”œâ”€â”€ Functions
    â””â”€â”€ Row Level Security
```

---

## Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DEPLOYMENT ARCHITECTURE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Railway    â”‚
                        â”‚  (Hosting)   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
        â”ƒ                                            â”ƒ
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                                â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
   â”‚  React   â”‚                                â”‚  Node.js â”‚
   â”‚   App    â”‚                                â”‚  Server  â”‚
   â”‚  (Vite)  â”‚                                â”‚ (Express)â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚                                           â”‚
        â”‚ Serves static files                      â”‚ API endpoints
        â”‚                                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                   Connects to
                        â”‚
                  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                  â”‚  Supabase  â”‚
                  â”‚ PostgreSQL â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Client Websites:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <script src="railway.app/journey-tracker.js">      â”‚
â”‚  <script src="railway.app/unified-workflow.js">     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

This diagram shows the complete flow from React UI to database storage to client execution!







