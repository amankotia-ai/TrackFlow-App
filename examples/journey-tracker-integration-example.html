<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Journey Tracker Integration Example</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      line-height: 1.6;
      color: #333;
    }
    
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 60px 40px;
      border-radius: 12px;
      margin-bottom: 40px;
      text-align: center;
    }
    
    .header h1 {
      margin: 0 0 10px 0;
      font-size: 42px;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .card {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .card h3 {
      margin: 0 0 10px 0;
      color: #667eea;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .card .value {
      font-size: 32px;
      font-weight: bold;
      color: #333;
    }
    
    .card .label {
      font-size: 12px;
      color: #718096;
      margin-top: 5px;
    }
    
    .content {
      background: white;
      border-radius: 8px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin: 5px;
      transition: all 0.3s;
    }
    
    .btn:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    .log {
      background: #1a202c;
      color: #a0aec0;
      padding: 20px;
      border-radius: 8px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      max-height: 400px;
      overflow-y: auto;
      margin-top: 20px;
    }
    
    .log-entry {
      margin: 5px 0;
      padding: 5px;
      border-left: 3px solid transparent;
    }
    
    .log-entry.success {
      border-color: #48bb78;
      color: #9ae6b4;
    }
    
    .log-entry.info {
      border-color: #4299e1;
      color: #90cdf4;
    }
    
    .log-entry.warning {
      border-color: #ed8936;
      color: #fbd38d;
    }
    
    .intent-bar {
      height: 30px;
      background: #e2e8f0;
      border-radius: 15px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .intent-fill {
      height: 100%;
      background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
      transition: width 0.5s;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 12px;
    }
  </style>
</head>
<body>
  
  <div class="header">
    <h1>üöÄ Journey Tracker Demo</h1>
    <p>This page demonstrates the Cookie-Free Journey Tracker in action</p>
  </div>

  <div class="dashboard">
    <div class="card">
      <h3>Pages Viewed</h3>
      <div class="value" id="page-count">0</div>
      <div class="label">Total pages in journey</div>
    </div>
    
    <div class="card">
      <h3>Time on Page</h3>
      <div class="value" id="time-on-page">0s</div>
      <div class="label">Current page duration</div>
    </div>
    
    <div class="card">
      <h3>Scroll Depth</h3>
      <div class="value" id="scroll-depth">0%</div>
      <div class="label">Maximum scroll depth</div>
    </div>
    
    <div class="card">
      <h3>Interactions</h3>
      <div class="value" id="interaction-count">0</div>
      <div class="label">Clicks and events</div>
    </div>
  </div>

  <div class="content">
    <h2>Intent Score</h2>
    <p>This score indicates how engaged the user is based on their behavior (0 = low, 1 = high)</p>
    <div class="intent-bar">
      <div class="intent-fill" id="intent-fill" style="width: 0%">0%</div>
    </div>
  </div>

  <div class="content">
    <h2>Visitor Information</h2>
    <p><strong>Returning Visitor:</strong> <span id="returning-visitor">No</span></p>
    <p><strong>Days Since First Visit:</strong> <span id="days-since">0</span></p>
    <p><strong>Session ID:</strong> <span id="session-id" style="font-family: monospace; font-size: 12px;">-</span></p>
  </div>

  <div class="content">
    <h2>Test Interactions</h2>
    <p>Click these buttons to track custom events and see how they affect your journey score:</p>
    <button class="btn" onclick="trackCustomEvent('video_watch')">üìπ Watch Video</button>
    <button class="btn" onclick="trackCustomEvent('download')">üì• Download Resource</button>
    <button class="btn" onclick="trackCustomEvent('signup_click')">‚úçÔ∏è Signup Click</button>
    <button class="btn" onclick="trackConversion()">üéâ Track Conversion</button>
    <button class="btn" onclick="viewJourneyData()">üëÅÔ∏è View Journey Data</button>
  </div>

  <div class="content">
    <h2>Activity Log</h2>
    <div class="log" id="activity-log"></div>
  </div>

  <!-- Journey Tracker Script -->
  <script src="../public/journey-tracker.js"></script>
  
  <script>
    // Initialize Journey Tracker
    const journeyTracker = new CookieFreeJourneyTracker({
      apiEndpoint: 'https://trackflow-app-production.up.railway.app/api/journey',
      enableTracking: true,
      debug: true, // Enable debug mode to see all events
      sendInterval: 30000, // Send data every 30 seconds
      maxJourneyLength: 50,
      
      // Custom intent scoring weights
      intentScoring: {
        pageViewWeight: 1,
        timeOnPageWeight: 2,
        scrollDepthWeight: 1.5,
        interactionWeight: 3
      }
    });

    // Initialize the tracker
    journeyTracker.initialize();
    
    // Log function
    function log(message, type = 'info') {
      const logDiv = document.getElementById('activity-log');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      const timestamp = new Date().toLocaleTimeString();
      entry.textContent = `[${timestamp}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
    }
    
    log('‚úÖ Journey Tracker initialized successfully', 'success');
    log('üéØ Tracking page views, time on page, scroll depth, and interactions', 'info');
    
    // Update dashboard metrics every second
    let startTime = Date.now();
    
    setInterval(() => {
      try {
        // Get current journey data
        const journey = journeyTracker.getCurrentJourney();
        const intentScore = journeyTracker.getIntentScore();
        const isReturning = journeyTracker.isReturningVisitor();
        const daysSince = journeyTracker.getDaysSinceFirstVisit();
        
        // Update page count
        document.getElementById('page-count').textContent = journey.pages?.length || 0;
        
        // Update time on page
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        document.getElementById('time-on-page').textContent = elapsed + 's';
        
        // Update scroll depth
        const scrollPercentage = Math.round(
          (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100
        ) || 0;
        document.getElementById('scroll-depth').textContent = scrollPercentage + '%';
        
        // Update interaction count
        const currentPage = journey.pages?.[journey.pages.length - 1];
        const interactions = currentPage?.interactions?.length || 0;
        document.getElementById('interaction-count').textContent = interactions;
        
        // Update intent score
        const intentPercent = Math.round(intentScore * 100);
        const intentFill = document.getElementById('intent-fill');
        intentFill.style.width = intentPercent + '%';
        intentFill.textContent = intentPercent + '%';
        
        // Update visitor info
        document.getElementById('returning-visitor').textContent = isReturning ? 'Yes' : 'No';
        document.getElementById('days-since').textContent = daysSince;
        document.getElementById('session-id').textContent = journey.sessionId || '-';
        
      } catch (error) {
        console.error('Dashboard update error:', error);
      }
    }, 1000);
    
    // Track custom events
    function trackCustomEvent(eventType) {
      journeyTracker.trackEvent({
        type: eventType,
        category: 'engagement',
        label: 'demo_page',
        value: 'test'
      });
      
      log(`üìä Custom event tracked: ${eventType}`, 'success');
    }
    
    // Track conversion
    function trackConversion() {
      journeyTracker.trackConversion({
        type: 'demo_conversion',
        value: 99.99,
        currency: 'USD'
      });
      
      log('üéâ Conversion tracked: $99.99', 'success');
    }
    
    // View journey data
    function viewJourneyData() {
      const journey = journeyTracker.getCurrentJourney();
      console.log('üìä Complete Journey Data:', journey);
      log('üìä Journey data logged to console (open DevTools)', 'info');
      
      // Also display summary
      const summary = {
        pages: journey.pages?.length || 0,
        intentScore: journeyTracker.getIntentScore(),
        isReturning: journeyTracker.isReturningVisitor(),
        daysSince: journeyTracker.getDaysSinceFirstVisit()
      };
      
      alert(JSON.stringify(summary, null, 2));
    }
    
    // Log scroll events
    let lastScrollLog = 0;
    window.addEventListener('scroll', () => {
      const now = Date.now();
      if (now - lastScrollLog > 5000) { // Log every 5 seconds
        const scrollPercentage = Math.round(
          (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100
        );
        log(`üìú Scroll depth: ${scrollPercentage}%`, 'info');
        lastScrollLog = now;
      }
    });
    
    // Log page unload
    window.addEventListener('beforeunload', () => {
      log('üëã Page unloading, journey data saved', 'warning');
    });
  </script>
</body>
</html>






